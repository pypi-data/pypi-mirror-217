{% for request_data in vars.requests.values() %}
    {% if request_data.type.generate %}
{{ request_data.actions['approve'].class|generate_import }}
{{ request_data.type.imports|generate_import }}
{% endif %}
{% endfor %}

{% for request_name, request_data in vars.requests.items() %}
{% if request_data.type.generate %}
class {{ request_data.type|class_header }}:

    type_id = "{{ request_name }}"
    name = "{{ request_name.capitalize() }}"

    available_actions = {
        **RequestType.available_actions,
        "accept": {{ request_data.actions['approve'].class|base_name }}
    }

    allowed_topic_ref_types = ["{{ vars.module.prefix_snake }}"] # On the Request record object, the topic is referenced by pid. This pid is
                                         # extracted by Resolver subclassed from RecordResolver, which has hardcoded
                                         # {"record": {pid}} as reference value. This reference is then by
                                         # setattr set on the Request record topic ReferencedEntityField, and the set
                                         # operation checks, whether this key is in allowed_topic_ref_types
    #TODO would it make sense to customize the topic ref types?
{% endif %}
{% endfor %}