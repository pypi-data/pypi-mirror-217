from invenio_records_resources.records.dumpers import CustomFieldsDumperExt
from oarepo_runtime.cf import CustomFields, InlinedCustomFields

class {{ vars.record|class_header }}:
    dumper_extensions = [
{% for cf in vars.custom_fields %}
        CustomFieldsDumperExt("{{cf.config}}"),
{% endfor %}
    ]

{% for cf in vars.custom_fields %}
{%if cf.element %}
    {{cf.element}} = CustomFields(
        "{{cf.config}}",
        "{{cf.element}}",
        clear_none=True,
        create_if_missing=True,
    )
{% else %}
    inlined_custom_fields = InlinedCustomFields("{{cf.config}}")
{% endif %}
{% endfor %}
