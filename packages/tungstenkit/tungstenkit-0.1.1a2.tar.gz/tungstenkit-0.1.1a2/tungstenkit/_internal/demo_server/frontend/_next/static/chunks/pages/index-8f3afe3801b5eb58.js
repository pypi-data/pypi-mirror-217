(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(9890)}])},9890:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return nC}});var r,i,s,l,o,a,c,u,d=t(5893),p=t(4523),m=t(9737),h=t(9008),x=t.n(h),f=t(3356),g=t(5117),j=t(9985),v=t(2445),y=t(7294),b=t(741),O=t(7789),w=t(1232),C=t(7564),T=t(8818),E=t(2185),I=t(1163);function S(e){let n=(0,I.useRouter)(),{ref:t}=(0,E.h)(),{avatar:r,buttons:i,tabs:s,activeTab:l,align:o,children:a}=e,c=e=>{let t=s.find(n=>n.value===e);t&&n.push(t.link)},u=null!=s?(0,d.jsx)(b.m,{value:l,defaultValue:l,onTabChange:c,color:"violet-manual.3",styles:e=>({tab:{"&:hover":{backgroundColor:e.colors.gray[0],borderColor:e.colors.gray[5]},"&[data-active]":{fontWeight:600},fontSize:e.fontSizes.md,height:"2rem",minWidth:"100px",borderWidth:"3px"},tabsList:{display:"flex",borderBottom:"none",gap:"1rem"},tabLabel:{marginBottom:"5px"},tabRightSection:{paddingLeft:"5px",marginBottom:"3px"}}),children:(0,d.jsx)(b.m.List,{children:s.map(e=>(0,d.jsx)(b.m.Tab,{value:e.value,rightSection:void 0!==e.badgeLabel&&null!==e.badgeLabel?(0,d.jsx)(O.C,{size:"sm",children:e.badgeLabel}):null,children:e.label},e.value))})}):void 0;return(0,d.jsx)(v.W,{pt:"1.5rem",bg:"#F7F8FA",sx:e=>({borderBottom:"1.5px solid ".concat(e.colors.gray[3])}),className:"layout-container",children:(0,d.jsxs)(v.W,{className:"layout-container-inner",children:[(0,d.jsxs)(w.Z,{spacing:"0rem",position:"apart",align:null!=o?o:"center",children:[(0,d.jsxs)(w.Z,{spacing:"1.5rem",align:null!=o?o:"center",children:[(0,d.jsx)(p.x,{ref:t,children:r}),(0,d.jsx)(C.K,{spacing:"sm",children:Array.isArray(a)?a.map((e,n)=>(0,d.jsx)("div",{children:e},"header-body-element-".concat(n.toString()))):a})]}),(0,d.jsx)(p.x,{mt:"5px",children:Array.isArray(i)?i.map((e,n)=>(0,d.jsx)("div",{children:e},"header-button-".concat(n.toString()))):i})]}),(0,d.jsx)(T.T,{h:"1.5rem",w:"100%",mt:"0.5rem"}),u]})})}var N=t(9876),k=function(){return(0,d.jsx)(p.x,{w:"100%",mih:"3rem"})},L=function(e){let{header:n,children:t}=e;return(0,d.jsxs)(N.k,{direction:"column",sx:{minHeight:"100vh"},children:[n,(0,d.jsx)(N.k,{direction:"column",sx:{flexGrow:1},children:t}),(0,d.jsx)(N.k,{direction:"column",sx:{flexGrow:0},children:(0,d.jsx)(k,{})})]})};function _(e){let{model:n,children:t}=e,r=(0,d.jsx)(g.x,{size:"xxl",fw:500,inline:!0,children:n.name}),i=(0,d.jsx)(S,{avatar:(0,d.jsx)(j.q,{src:n.avatar_url,size:"70px",radius:"0"}),align:"center",children:r});return(0,d.jsx)(L,{header:i,children:(0,d.jsx)(v.W,{my:"2rem",className:"layout-container",children:(0,d.jsx)(v.W,{className:"layout-container-inner",children:t})})})}var F=t(6154),R=t(4155);let z=()=>{console.log(R.env);let e=F.Z.create({timeout:3e3});return e};var Z=t(2819),P=t(8767),B=function(e){return Object.freeze({axiosInstance:e,create:function(n){return e.post("/predictions",n,{headers:{accept:"application/json","Content-Type":"application/json"}})},get:function(n){return e.get("/predictions/".concat(n))},cancel:function(n){return e.post("/predictions/".concat(n,"/cancel"))}})};function A(e){let{failureReason:n,logsArea:t}=e;return(0,d.jsxs)(C.K,{children:[(0,d.jsx)(g.x,{color:"red.6",fw:500,children:function(e){switch(e){case"user_failure":return"Model run failed. See the logs below.";case"system_failure":return"An unexpected error occurred. If you encounter this repeatedly, please send us feedback.";case"timeout":return"Timeout Reached";default:return"ERROR".concat(e?": ".concat(e):"")}}(n)}),t]})}var H=t(966);function M(e){let{status:n,logsArea:t}=e;return(0,d.jsxs)(C.K,{children:[(0,d.jsxs)(w.Z,{children:[(0,d.jsx)(g.x,{fw:500,children:n.charAt(0).toUpperCase()+n.slice(1)}),(0,d.jsx)(H.a,{color:"gray",variant:"dots",size:"sm"})]}),t]})}var W=t(825);function K(e){let{title:n,rightIcon:t,children:r,...i}=e;return(0,d.jsxs)(W.Z,{withBorder:!0,padding:"lg",radius:"lg",h:"fit-content",...i,children:[(0,d.jsx)(W.Z.Section,{withBorder:!0,inheritPadding:!0,py:"sm",children:(0,d.jsxs)(w.Z,{position:"apart",children:["string"==typeof n?(0,d.jsx)(g.x,{fz:"xl",fw:600,children:n}):n,t]})}),(0,d.jsx)(p.x,{pt:"md",children:r})]})}var U=t(3523),q=t(2870);function D(){return(0,d.jsxs)(C.K,{align:"center",justify:"center",spacing:"lg",py:"xl",children:[(0,d.jsx)(U.M,{children:(0,d.jsx)(q.E,{mx:"auto",maw:"40%",opacity:.3,alt:"tungsten_logo",src:"/tungsten_greyed_out_logo.png"})}),(0,d.jsx)(g.x,{color:"gray.6",fz:"md",children:'Click "Run" to see amazing results.'})]})}var J=t(8104);function V(e){let{name:n,description:t,required:r}=e,i=(0,J.rZ)(),s=i.fn.variant({variant:"filled",color:"red"}).background;return(0,d.jsxs)(C.K,{spacing:"xxs",mb:"xs",children:[(0,d.jsxs)(p.x,{children:[(0,d.jsxs)(g.x,{fw:500,fz:"md",span:!0,children:[n," "]}),r&&(0,d.jsx)(g.x,{span:!0,color:s,children:"*"})]}),t?(0,d.jsx)(g.x,{color:"gray.7",fz:"sm",children:t}):void 0]})}var Y=t(983),G=t(2679),X=t(7297),Q=t(7841),$=t(2276),ee=t(7311),en=t(2015);function et(){let e=(0,X.Z)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  height: 100px;\n  width: 100%;\n  background: transparent;\n  gap: 2rem;\n"]);return et=function(){return e},e}function er(){let e=(0,X.Z)(["\n  width: 100%;\n  height: 90px;\n"]);return er=function(){return e},e}function ei(){let e=(0,X.Z)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 60px;\n  height: 60px;\n  background: #e9e9e9;\n  border: 1px black;\n  outline: none;\n  cursor: pointer;\n  padding-bottom: 3px;\n  &:hover {\n    background: #ddd;\n  }\n"]);return ei=function(){return e},e}let es=en.ZP.div(et()),el=en.ZP.div(er());en.ZP.button(ei());var eo=function(e){let{src:n}=e,r=(0,y.useId)(),[i,s]=(0,y.useState)(!1),[l,o]=(0,y.useState)(),a=!0;(0,y.useEffect)(()=>{if(a){let e=async()=>{let e=(await t.e(33).then(t.t.bind(t,1796,23))).default,i=document.getElementById("waveform".concat(r)),l=e.create({barWidth:3,barRadius:3,barGap:2,barMinHeight:1,cursorWidth:1,container:i,backend:"WebAudio",height:80,progressColor:"#black",responsive:!0,waveColor:"#C4C4C4",cursorColor:"transparent"});o(l),l.load(n),l.on("finish",()=>{s(!1)})};e(),a=!1}},[]);let c=e=>{s(!i),e&&e.playPause()};return(0,d.jsx)(p.x,{sx:{maxWidth:"90%"},children:(0,d.jsx)(p.x,{style:{padding:"0px",margin:"0px"},children:(0,d.jsxs)(es,{style:{padding:"0px",margin:"0px",height:"90px"},children:[(0,d.jsx)(Q.z,{sx:e=>({border:"none",borderRadius:e.radius.sm,width:"120px"}),variant:"contained",leftIcon:i?(0,d.jsx)($.Z,{}):(0,d.jsx)(ee.Z,{}),onClick:e=>c(l),children:i?"Pause":"Play"}),(0,d.jsx)(el,{id:"waveform".concat(r),style:{padding:"0px",margin:"0px",height:"80px"}})," ",(0,d.jsx)("audio",{id:"track".concat(r),src:n,style:{padding:"0px",margin:"0px"}})]})})})},ea=t(335);function ec(e){let{src:n}=e;return(0,d.jsx)(Q.z,{component:"a",href:n,target:"_blank",variant:"default",leftIcon:(0,d.jsx)(ea.Z,{size:"1rem"}),children:"Download file"})}var eu=t(5215);t(1717);var ed=function(e){let{src:n,mimeType:t,autoplay:r=!1,controls:i=!0,responsive:s=!0,fluid:l=!0}=e,o=(0,y.useRef)(null),a=(0,y.useRef)(null),c=(e,n)=>{n.current=e};return(0,y.useEffect)(()=>{let e={autoplay:r,controls:i,responsive:s,fluid:l,sources:[{src:n,type:t}]};if(a.current){let n=a.current;n.autoplay(e.autoplay),n.src(e.sources)}else{var u;let n=document.createElement("video-js");n.classList.add("vjs-big-play-centered"),null===(u=o.current)||void 0===u||u.appendChild(n);let t=a.current=(0,eu.Z)(n,e,()=>{c&&c(t,a)})}},[n,t,r,i,s,l,o]),(0,y.useEffect)(()=>{let e=a.current;return()=>{e&&!e.isDisposed()&&(e.dispose(),a.current=null)}},[a]),(0,d.jsx)(N.k,{direction:"column",sx:{maxWidth:"100%",gap:"0.4rem"},children:(0,d.jsx)(p.x,{"data-vjs-player":!0,children:(0,d.jsx)("div",{ref:o,style:{}})})})};let ep=e=>{if("string"!=typeof e)return e.type;let n=(0,Y.lookup)(e);return n||"application/octet-stream"},em=(0,y.forwardRef)((e,n)=>{let t;let{file:r,filetype:i}=e,[s,l]=(0,y.useState)("string"==typeof r?r:URL.createObjectURL(r)),o=ep(r),a=(0,d.jsx)(p.x,{});switch((0,y.useEffect)(()=>{l("string"==typeof r?r:URL.createObjectURL(r))},[r]),i){case"image":t=s?(0,d.jsx)(G.LazyLoadImage,{src:s,style:{maxWidth:"100%",maxHeight:"100%"},alt:i}):a;break;case"video":t=s?(0,d.jsx)(ed,{src:s,mimeType:o}):a;break;case"audio":t=s?(0,d.jsx)(eo,{src:s}):a;break;default:t=s?(0,d.jsx)(ec,{src:s}):a}return(0,d.jsx)(p.x,{maw:"100%",mah:"100%",ref:n,children:t})});function eh(e,n){if(n)return s.FILE;if(e.choices&&e.type&&["string","number","integer"].includes(e.type)){if("string"===e.type)return s.STR_CHOICE;if("integer"===e.type)return s.INT_CHOICE;if("number"===e.type)return s.FLOAT_CHOICE}return"integer"===e.type?void 0!==e.minimum||void 0!==e.maximum?s.CONINT:s.INT:"number"===e.type?void 0!==e.minimum||void 0!==e.maximum?s.CONFLOAT:s.FLOAT:"boolean"===e.type?s.BOOL:void 0!==e.min_length||void 0!==e.max_length?s.CONSTR:s.STR}em.defaultProps={filetype:"binary"},em.displayName="FileView",(r=s||(s={}))[r.FILE=0]="FILE",r[r.STR=1]="STR",r[r.CONSTR=2]="CONSTR",r[r.INT=3]="INT",r[r.CONINT=4]="CONINT",r[r.FLOAT=5]="FLOAT",r[r.CONFLOAT=6]="CONFLOAT",r[r.BOOL=7]="BOOL",r[r.STR_CHOICE=8]="STR_CHOICE",r[r.INT_CHOICE=9]="INT_CHOICE",r[r.FLOAT_CHOICE=10]="FLOAT_CHOICE",(i=l||(l={}))[i.FILE=0]="FILE",i[i.FILE_LIST=1]="FILE_LIST",i[i.FILE_DICT=2]="FILE_DICT",i[i.STR=3]="STR",i[i.NUMBER=4]="NUMBER",i[i.BOOL=5]="BOOL",i[i.JSON=6]="JSON";var ex=t(2328),ef=t(665),eg=t(7577),ej=t(5887),ev=t(8393),ey=t(9834),eb=t(8198),eO=t(3625);function ew(e){let{value:n,iconSize:t,...r}=e;return(0,d.jsx)(eg.a,{opacity:0,sx:{pointerEvents:"none"},...r,children:(0,d.jsx)(w.Z,{position:"right",align:"center",children:(0,d.jsx)(ej.q,{value:"string"==typeof n?n:n.toString(),timeout:2e3,children:e=>{let{copied:n,copy:r}=e;return(0,d.jsx)(ev.u,{label:n?"Copied":"Copy",withArrow:!0,position:"bottom",children:(0,d.jsx)(ey.A,{variant:"light",color:n?"button-blue":"gray",onClick:r,sx:{pointerEvents:"all"},children:n?(0,d.jsx)(eb.Z,{size:t}):(0,d.jsx)(eO.Z,{size:t})})})}})})})}ew.defaultProps={iconSize:"1rem"};var eC=t(6817),eT=t(6768),eE=(0,eC.k)((e,n)=>{let{color:t}=n,r=t||("dark"===e.colorScheme?"dark":"gray"),i=e.fn.variant({color:r,variant:"light"});return{root:{...e.fn.fontStyles(),lineHeight:e.lineHeight,padding:"".concat((0,eT.h)(2)," calc(").concat(e.spacing.xs," / 2)"),borderRadius:e.radius.sm,color:"dark"===e.colorScheme?"dark"===r?e.colors.dark[0]:e.white:e.colors.dark[7],backgroundColor:"dark"===e.colorScheme&&"dark"===r?e.colors.dark[5]:i.background,fontFamily:e.fontFamilyMonospace,fontSize:e.fontSizes.xs},block:{padding:e.spacing.xs,margin:0,whiteSpace:"pre-wrap",wordBreak:"break-all"}}});let eI={fz:"sm"},eS=(0,y.forwardRef)((e,n)=>{let{className:t,children:r,color:i,unstyled:s,variant:l,mono:o,ff:a,noCopy:c,...u}=(0,J.N4)("Code",eI,e),{classes:m,cx:h}=eE({color:i},{name:"Code",unstyled:s,variant:l}),x=(0,J.rZ)(),{ref:f,x:g,y:j}=(0,ex.i)({resetOnExit:!0}),v=(0,ef.Y)(f,n);return(0,d.jsx)(p.x,{ff:null!=a?a:o?x.fontFamilyMonospace:x.fontFamily,className:h(m.root,m.block,t),ref:v,...u,children:(0,d.jsxs)(p.x,{pos:"relative",children:[null!=r&&""!==r?r:(0,d.jsx)(p.x,{children:"\xa0"}),!0!==c&&(0!==g||0!==j)&&null!=r&&""!==r&&(0,d.jsx)(ew,{value:"string"==typeof r?r:r.toString(),iconSize:"1rem"})]})})});function eN(e){let{fieldName:n,propObj:t,filetype:r,itemFiletype:i,value:s}=e,o=function(e,n,t){let r=Object.keys(e),i="array"===e.type,s="object"===e.type&&r.includes("additionalProperties");return n?l.FILE:i&&t?l.FILE_LIST:s&&t?l.FILE_DICT:"integer"===e.type||"number"===e.type?l.NUMBER:"boolean"===e.type?l.BOOL:"string"===e.type?l.STR:l.JSON}(t,r,i);switch(o){case l.FILE:return(0,d.jsx)(em,{file:s,filetype:r});case l.FILE_LIST:return(0,d.jsx)(C.K,{spacing:"xxs",children:s.map((e,r)=>(0,d.jsx)(eN,{fieldName:"".concat(n,"-").concat(r.toString()),propObj:t.items,filetype:i,value:e},"".concat(n,"-").concat(r.toString())))});case l.FILE_DICT:return(0,d.jsx)(C.K,{spacing:"xxs",children:Object.keys(s).map(e=>(0,d.jsxs)("div",{children:[(0,d.jsx)(V,{description:e},e),(0,d.jsx)(eN,{fieldName:"".concat(n,"-").concat(e),propObj:t.additionalProperties,filetype:i,value:s[e]})]},"".concat(n,"-").concat(e)))});case l.STR:return(0,d.jsx)(eS,{children:s});case l.BOOL:case l.NUMBER:return(0,d.jsx)(eS,{children:s.toString()});case l.JSON:return(0,d.jsx)(eS,{children:JSON.stringify(s,void 0,2)});default:throw TypeError("Unkown output field type ".concat(o," "))}}function ek(e){let{schema:n,filetypes:t,values:r,spacing:i}=e,s=[];return Object.keys(n.properties).forEach(e=>{s.push({name:e,component:function(e){let i=n.properties[e],s=t[e];return(0,d.jsx)(eN,{fieldName:e,propObj:i,filetype:s,itemFiletype:t["".concat(e,".$item")],value:r[e]})}(e)})}),(0,d.jsx)(C.K,{fz:"md",spacing:i,children:s.map(e=>(0,d.jsxs)("div",{children:[(0,d.jsx)(V,{name:e.name}),e.component]},"output-field-".concat(e.name)))})}eS.displayName="CodeBlockWithLinebreak",ek.defaultProps={spacing:"md"};var eL=t(3723);function e_(e){let{children:n,autoScroll:t,fz:r,h:i}=e,s=(0,y.useRef)(null),{ref:l,width:o,height:a}=(0,E.h)(),{ref:c,x:u,y:m}=(0,ex.i)({resetOnExit:!0}),h=(0,ef.Y)(l,c),x=!!t&&(0===u||0===m),f=e=>{var n;null==s||null===(n=s.current)||void 0===n||n.scrollTo({top:s.current.scrollHeight,behavior:e})};return(0,y.useEffect)(()=>{t&&x&&f(t)},[x,t,n]),(0,d.jsxs)(p.x,{pos:"relative",ref:h,children:[(0,d.jsx)(eL.x,{viewportRef:s,h:i,children:(0,d.jsx)(eS,{fz:r,miw:o,mih:a,mono:!0,noCopy:!0,children:n})}),(0!==u||0!==m)&&(0,d.jsx)(ew,{p:".3rem",value:null!=n?n:""})]})}function eF(e){let{mode:n,output:t,demoOutput:r,demoOutputSchema:i,demoOutputFiletypes:s,logs:l}=e,o=(0,d.jsx)(ek,{schema:i,filetypes:s,values:r}),a=(0,d.jsx)(eS,{fz:"xs",mono:!0,children:JSON.stringify(t,null,2)}),c=(0,d.jsx)(e_,{children:null!=l?l:""});return(0,d.jsxs)(d.Fragment,{children:["preview"===n&&o,"raw"===n&&a,"logs"===n&&c]})}e_.defaultProps={fz:"xs",h:"30vh",children:""};var eR=t(3819),ez=t(5158),eZ=t(2972),eP=t(7080);function eB(e){let{icon:n,label:t}=e;return(0,d.jsxs)(U.M,{children:[n,(0,d.jsx)(p.x,{ml:10,children:t})]})}function eA(e){let{mode:n,onChange:t,w:r,iconSize:i,...s}=e,l={size:void 0===i?"1rem":i};return(0,d.jsx)(eR.s,{value:n,onChange:t,w:null!=r?r:"100%",data:[{label:(0,d.jsx)(eB,{icon:(0,d.jsx)(ez.Z,{...l}),label:"Preview"}),value:"preview"},{label:(0,d.jsx)(eB,{icon:(0,d.jsx)(eZ.Z,{...l}),label:"Raw"}),value:"raw"},{label:(0,d.jsx)(eB,{icon:(0,d.jsx)(eP.Z,{...l}),label:"Logs"}),value:"logs"}],...s})}var eH=t(930),eM=t(2615),eW=t(4796),eK=t(2675),eU=t(8431),eq=t(1885),eD=t(1500),eJ=t(6261),eV=t(971),eY=t(4151),eG=t(3540),eX=t(5851),eQ=t(7339),e$=t(8044),e0=t(5204),e1=t(6862),e5=t(904),e7=t(7283);let e3={iconSize:"1.1rem",textProps:{fz:"md"}};function e8(e){let n;let{wrapperProps:t,value:r,defaultValue:i,filetype:s,onChange:l,textProps:o,maxsize:a,iconSize:c}=(0,eJ.k)("DropzoneInput",e3,e),[u,m]=(0,eX.C)({value:r,onChange:l,finalValue:null}),h=(0,J.rZ)();return i&&m(i),(0,d.jsx)(eY.I.Wrapper,{...t,children:(0,d.jsxs)(C.K,{spacing:"xs",children:[u?function(e){let n=(0,d.jsx)(em,{file:e,filetype:s}),t=typeof e!==i?(0,d.jsxs)(w.Z,{maw:"100%",spacing:"xs",children:[(0,d.jsx)(g.x,{fz:"xs",color:"gray.7",children:"string"==typeof e?decodeURI(e.split("/").pop()):"".concat(e.name," (").concat(function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!+e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,t)).toFixed(n<0?0:n))," ").concat(["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"][t])}(e.size),")")}),(0,d.jsx)(eV.P,{title:"Delete file",color:"gray.7",onClick:()=>m(null)})]}):void 0;return(0,d.jsxs)(C.K,{spacing:"xs",maw:"100%",children:["image"===s?(0,d.jsx)(p.x,{maw:"50%",children:n}):n,t]})}(u):void 0,(0,d.jsx)(eG.fh,{onDrop:e=>{e.length>0&&void 0!==l&&(m(e[0]),l(e[0]))},maxSize:a,accept:function(){if(["audio","video","image"].includes(s)){let e={};for(let[n,t]of Object.entries(Y.extensions))n.startsWith(s)&&(e[n]=t.map(e=>".".concat(e)));return e}}(),maxFiles:1,children:(0,d.jsxs)(w.Z,{position:"center",spacing:"md",style:{pointerEvents:"none"},children:[(0,d.jsx)(eG.fh.Accept,{children:(0,d.jsx)(e5.Z,{color:h.colors[h.primaryColor][5],size:c})}),(0,d.jsx)(eG.fh.Reject,{children:(0,d.jsx)(e7.Z,{color:h.colors.red[6],size:c})}),(0,d.jsx)(eG.fh.Idle,{children:(n="image"===s?eQ.Z:"video"===s?e$.Z:"audio"===s?e0.Z:e1.Z,(0,d.jsx)(n,{size:c}))}),(0,d.jsxs)(g.x,{inline:!0,...o,children:["Drag ",s," file here or click to select"]})]})})]})})}var e2=t(6801),e4=t(806),e9=t(4419);e9.ZP.registerCustom({isApplicable:e=>e instanceof File,serialize:e=>"null",deserialize:e=>null},"decimal.js");let{stringify:e6}=e9.ZP,{parse:ne}=e9.ZP,nn="This field is required.",[nt,nr,ni]=(0,e2.W)(),ns=e=>{let{schema:n,filetypes:t,initialValues:r}=e,i=Object.keys(n.properties),l=Object.fromEntries(i.map(e=>[e,r&&r[e]?r[e]:function(e){let r=n.properties[e],i=eh(r,t[e]),l=r.default;if(null==l)switch(i){case s.STR:case s.CONSTR:case s.INT:case s.FLOAT:case s.CONINT:case s.CONFLOAT:l="";break;case s.BOOL:l=!1;break;default:l=null}return l}(e)])),{onSubmit:o,values:a,setFieldValue:c,isTouched:u,setTouched:d,...p}=ni({initialValues:l,validate:Object.fromEntries(i.map(e=>[e,function(e){let r=n.properties[e],i=null!=n.required&&n.required.includes(e),l=eh(r,t[e]),o=e=>null==e?i?nn:void 0:"string"!=typeof e&&"string"==typeof e&&!function(e){let n;try{n=new URL(e)}catch(e){return!1}return"http:"===n.protocol||"https:"===n.protocol}(e)?"Not an HTTP(s) URL.":void 0,a=e=>{if(null==e)return i?nn:void 0;if("string"!=typeof e)throw TypeError("Invalid type for string form");return 0===e.length?i?nn:void 0:void 0!==r.max_length&&e.length>r.max_length?"Maximum length is ".concat(r.max_length," characters."):void 0!==r.min_length&&e.length<r.min_length?"Minimum length is ".concat(r.min_length," characters."):void 0},c=e=>{if(null==e||"string"==typeof e&&0===e.length)return i?nn:void 0;if("number"!=typeof e)throw TypeError("Invalid type for number form");return void 0!==r.maximum&&e>r.maximum?"Maximum value is ".concat(r.maximum):void 0!==r.minimum&&e<r.minimum?"Minimum value is ".concat(r.minimum,"."):void 0};switch(l){case s.FILE:return o;case s.STR:case s.CONSTR:case s.STR_CHOICE:return a;case s.CONFLOAT:case s.FLOAT:case s.CONINT:case s.INT:case s.INT_CHOICE:case s.FLOAT_CHOICE:return c;default:return}}(e)]))}),m=(e,t)=>{let r=(t,r)=>e(Object.fromEntries(i.map(e=>[e,function(e,t){let r=n.properties[e];return null==t?r.default:t}(e,t[e])])),r);return o(r,t)},h=(0,I.useRouter)(),[x,f]=(0,e4.X)({key:"prediction-input-form",defaultValue:null,serialize:e6,deserialize:e=>void 0===e?null:ne(e)});return(0,y.useEffect)(()=>{var e;let r=()=>{f({path:h.asPath,schema:n,filetypes:t,values:a})};return null===(e=h.events)||void 0===e||e.on("routeChangeStart",r),document.documentElement.addEventListener("mouseleave",r),null==window||window.addEventListener("beforeunload",r),()=>{document.documentElement.removeEventListener("mouseleave",r),null==window||window.removeEventListener("beforeunload",r)}},[n,t,h,f,a]),(0,y.useEffect)(()=>{null!=x&&(null==x?void 0:x.values)&&(null==x?void 0:x.path)===h.asPath&&(null==x?void 0:x.schema)!=null&&JSON.stringify(null==x?void 0:x.schema)===JSON.stringify(n)&&(null==x?void 0:x.filetypes)!=null&&JSON.stringify(null==x?void 0:x.filetypes)===JSON.stringify(t)&&Object.keys(x.values).forEach(e=>{(null==t[e]||null!=x.values[e])&&(c(e,x.values[e]),d({[e]:!0}))})},[x,c,n,t,h.asPath,d]),{onSubmit:m,values:a,setFieldValue:c,isTouched:u,setTouched:d,...p}},nl=()=>({placeholder:"Select one",rightSection:(0,d.jsx)(eD.Z,{size:"1rem"})}),no=e=>({min:null!==(o=e.minimum)&&void 0!==o?o:void 0,max:null!==(a=e.maximum)&&void 0!==a?a:void 0,styles:{markLabel:{display:"none"},label:{display:"none"}}}),na=e=>({min:null!==(c=e.minimum)&&void 0!==c?c:void 0,max:null!==(u=e.maximum)&&void 0!==u?u:void 0,stepHoldDelay:500,stepHoldInterval:100,removeTrailingZeros:!0});function nc(e){let{fieldName:n,fieldProp:t,filetype:r}=e,i=nr(),l=i.getInputProps(n),o=eh(t,r);switch(o){case s.FILE:return(0,d.jsx)(e8,{filetype:r,maxsize:1073741824,iconSize:"1.1rem",textProps:{size:"sm"},...l});case s.STR:case s.CONSTR:return(0,d.jsx)(eM.g,{autosize:!0,minRows:1,...l});case s.INT:case s.FLOAT:return(0,d.jsx)(eW.Y,{w:"100%",precision:o===s.INT?1:10,step:o===s.INT?1:.01,...na(t),...l});case s.CONINT:case s.CONFLOAT:return(0,d.jsxs)(w.Z,{spacing:"1rem",children:[(0,d.jsx)(eW.Y,{w:"calc(30% - 1rem)",precision:o===s.CONINT?0:10,step:o===s.CONINT?1:.01,...na(t),...l}),(0,d.jsx)(eK.i,{w:"70%",value:l.value,onChange:l.onChange,step:o===s.CONINT?1:.01,...no(t)})]});case s.STR_CHOICE:if(null==t.choices)throw TypeError("No choices");return(0,d.jsx)(eU.Ph,{data:t.choices,...l,...nl()});case s.BOOL:return(0,d.jsx)(eq.r,{...l});case s.INT_CHOICE:case s.FLOAT_CHOICE:if(null==t.choices)throw TypeError("No choices");return(0,d.jsx)(eU.Ph,{value:null!=l.value?l.value.toString():null,data:t.choices.map(e=>e.toString()),onChange:e=>{let n=null;"string"==typeof e&&(n=Number(e)),l.onChange(n)},...Object.fromEntries(Object.entries(l).filter(e=>!["onChange","value"].includes(e[0])))});default:throw TypeError("Unknown field type ".concat(o))}}function nu(e){let{filetype:n,value:t}=e;if(n)return(0,d.jsx)(em,{file:t,filetype:n});if(void 0!==t)return(0,d.jsx)(eS,{children:"string"!=typeof t?t.toString():t});throw Error("`value` is undefined")}function nd(e){let{withForm:n,schema:t,filetypes:r,values:i,showOptions:s,spacing:l}=e,o=[],a=[];function c(e){return(null==t?void 0:t.required)!=null&&(null==t?void 0:t.required.includes(e))}function u(e){let s=t.properties[e],l=r[e];return n?(0,d.jsx)(nc,{fieldName:e,fieldProp:s,filetype:l}):(0,d.jsx)(nu,{filetype:l,value:void 0===i?void 0:i[e]})}return Object.keys(t.properties).forEach(e=>{c(e)&&o.push({name:e,component:u(e)})}),Object.keys(t.properties).forEach(e=>{c(e)||a.push({name:e,component:u(e)})}),(0,d.jsxs)(p.x,{fz:"md",children:[(0,d.jsx)(C.K,{spacing:l,children:o.map(e=>(0,d.jsxs)("div",{children:[(0,d.jsx)(V,{name:e.name,required:!!n,description:n?t.properties[e.name].description:void 0}),e.component]},"input-field-".concat(e.name)))}),s&&a.length>0?(0,d.jsx)(T.T,{h:l}):void 0,(0,d.jsx)(eH.U,{in:null!=s&&s,children:(0,d.jsx)(C.K,{spacing:l,children:a.map(e=>(0,d.jsxs)("div",{children:[(0,d.jsx)(V,{name:e.name,required:!1,description:n?t.properties[e.name].description:void 0}),e.component]},"input-field-".concat(e.name)))})})]})}nd.defaultProps={spacing:"md",values:void 0,showOptions:!1};var np=t(8078);function nm(e){let{checked:n,onChange:t,...r}=e;return(0,d.jsx)(np.X,{label:"Show options",checked:n,onChange:e=>t(e.currentTarget.checked),...r})}var nh=t(3575);let nx={height:"3rem"},nf=e=>nh.N9.show({message:"".concat(e),color:"red",sx:nx});var ng=t(4075);let nj=(0,y.forwardRef)((e,n)=>{var t,r;let i;let{prediction:s,model:l,setPrediction:o}=e,{demo_output_schema:a,demo_output_filetypes:c}=l,u=new f.Z,m=z(),h=B(m),[x,g]=(0,y.useState)("preview"),j=(0,P.useMutation)({mutationFn:()=>(u.remove("current_prediction",{path:"/"}),o(null),h.cancel(s.id))}),v=(null==s?void 0:s.status)&&["pending","running"].includes(s.status)?"auto":"smooth",b=(0,d.jsx)(e_,{autoScroll:v,children:null!==(t=null==s?void 0:s.logs)&&void 0!==t?t:""}),O=(0,d.jsx)(T.T,{h:"md"}),C=(0,d.jsx)(T.T,{h:"xl"});switch(null==s?void 0:s.status){case"pending":case"running":i=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(M,{status:s.status,logsArea:"running"===s.status?b:void 0}),O,(0,d.jsx)(Q.z,{onClick:()=>j.mutate(),variant:"default",fullWidth:!0,children:"Cancel"})]});break;case"failed":i=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(A,{failureReason:s.failure_reason,logsArea:b}),C]});break;case"success":i=(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(eA,{mode:x,onChange:g}),O,(0,d.jsx)(eF,{mode:x,output:s.output,demoOutput:s.demo_output,demoOutputSchema:a,demoOutputFiletypes:c,logs:null!==(r=null==s?void 0:s.logs)&&void 0!==r?r:""}),C,(0,d.jsx)(w.Z,{position:"right",children:(0,d.jsx)(Q.z,{variant:"default",onClick:()=>{window.scrollTo({top:0,behavior:"auto"}),u.remove("current_prediction",{path:"/"}),o(null)},leftIcon:(0,d.jsx)(ng.Z,{size:"1rem"}),children:"Clear"})})]});break;default:i=(0,d.jsx)(D,{})}return(0,d.jsx)(p.x,{ref:n,children:i})});nj.displayName="ModelRunProgress";var nv=t(9204),ny=t(8697);function nb(e){var n,t,r;let{model:i,currentPrediction:s,onFormSubmit:l,onError:o}=e,{input_schema:a,input_filetypes:c}=i,u=(0,I.useRouter)(),p=z(),m=Object.freeze({axiosInstance:p,upload:function(e){let n=new FormData;return n.append("file",e),p.post("/files",n,{timeout:3e5,headers:{"Content-Type":"multipart/form-data"}})}}),[h,x]=(0,y.useState)(!1),[f,g]=(0,y.useState)(!1),[j,v]=(0,y.useState)(!1),{start:b}=(0,ny.K)(()=>v(!1),2e3),O=()=>{v(!0),b()},E=ns({schema:a,filetypes:c});null===(n=u.events)||void 0===n||n.on("routeChangeComplete",()=>{g(!1),v(!1)}),null===(t=u.events)||void 0===t||t.on("routeChangeError",()=>{g(!1),v(!1)});let S=async e=>{let n;return n=e instanceof File?await m.upload(e).then(e=>e.data.serving_url).catch(e=>(n=null,(0,nv.IZ)(e)&&e.response&&401===e.response.status&&u.push("/sign_in"),n)):e},N=async e=>{g(!0),O();let n=Object.keys(i.input_schema.properties),t=n.filter(e=>!!i.input_filetypes[e]),r=t.map(n=>S(e[n])),s=await Promise.all(r);if(s.some(e=>null==e)){o(),g(!1);return}let a=Object.fromEntries(n.map(n=>{let r=t.indexOf(n);return r>=0?[n,s[r]]:[n,e[n]]}));l(a),g(!1)},{setValues:k}=E;return(0,y.useLayoutEffect)(()=>{null!=s&&k(s.input)},[s,k]),(0,d.jsxs)(C.K,{w:"100%",spacing:"0",children:[null!=(r=i.input_schema).required&&Object.keys(r.properties).some(e=>{var n;return!(null===(n=r.required)||void 0===n?void 0:n.includes(e))})?(0,d.jsx)(w.Z,{position:"right",children:(0,d.jsx)(nm,{checked:h,onChange:x})}):void 0,(0,d.jsx)(nt,{form:E,children:(0,d.jsxs)("form",{onSubmit:E.onSubmit(N),children:[(0,d.jsx)(nd,{withForm:!0,schema:a,filetypes:c,showOptions:h}),(0,d.jsx)(T.T,{h:"xxl"}),(0,d.jsxs)(w.Z,{position:"right",grow:!0,children:[(0,d.jsx)(Q.z,{onClick:E.reset,leftIcon:(0,d.jsx)(ng.Z,{size:"1rem"}),variant:"default",children:"Reset"}),(0,d.jsx)(Q.z,{leftIcon:(0,d.jsx)(ee.Z,{size:"1rem"}),color:"run-green.4",loading:f||j,type:f||j?void 0:"submit",children:"Run"})]})]})})]})}let nO="Failed to run by unexpected server error";function nw(e){let{model:n,currentPrediction:t}=e,r=z(),i=B(r),s=new f.Z,[l,o]=(0,y.useState)(t),{scrollIntoView:a,targetRef:c}=(0,Z.g)({axis:"y"}),u=(0,P.useMutation)({mutationFn:e=>{let n=i.create(e);return null!=l&&["pending","running"].includes(l.status)?i.cancel(l.id).then(()=>n):n},onSuccess:e=>{let{data:n}=e;s.set("current_prediction",n.id,{path:"/"}),console.log(n),o(n),a({alignment:"start"})},onError:()=>{nf(nO)}});return(0,P.useQuery)({enabled:null!=l&&("running"===l.status||"pending"===l.status),retry:5,refetchInterval:500,queryKey:"",queryFn:()=>i.get(l.id),onSuccess:e=>o(e.data),onError:()=>nf("Failed to update the status from server")}),(0,d.jsxs)(w.Z,{w:"100%",spacing:"2rem",align:"top",grow:!0,children:[(0,d.jsx)(K,{title:"Input",children:(0,d.jsx)(nb,{model:n,currentPrediction:t,onFormSubmit:u.mutate,onError:()=>nf(nO)})}),(0,d.jsx)(K,{title:"Output",children:(0,d.jsx)(nj,{ref:c,prediction:l,model:n,setPrediction:o})})]})}function nC(){let e=z(),n=Object.freeze({axiosInstance:e,get:function(){return e.get("/metadata")}}),t=B(e),r=new f.Z,[i,s]=(0,y.useState)(null),[l,o]=(0,y.useState)(null);return(0,y.useLayoutEffect)(()=>{(async function(){await n.get().then(e=>s(e.data)).catch(()=>{nf("Failed to load model metadata by unexpected server error")})})()},[]),(0,y.useEffect)(()=>{var e;let n=null!==(e=r.get("current_prediction"))&&void 0!==e?e:null;(async function(){n&&await t.get(n).then(e=>{let{data:n}=e;o(n)}).catch(()=>null)})()},[i]),(0,d.jsxs)(p.x,{children:[i?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(x(),{children:[(0,d.jsx)("title",{children:"".concat(i.name," - Run | Tungsten")}),(0,d.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,d.jsx)(_,{model:i,children:(0,d.jsx)(nw,{model:i,currentPrediction:l})})]}):void 0,(0,d.jsx)(m.f,{visible:null==i})]})}},7579:function(){}},function(e){e.O(0,[544,657,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);