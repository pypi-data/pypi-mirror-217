(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{28:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(6),i=n.n(a),s=n(29),o=n.n(s),c=n(5),l=n(4),r=n(7),d=n(11),b=n(0),h=n(1),u=n(2),j=n(3),v=n(26),m=(n(28),n(33)),g=n(12),O=n(8),f=function(e){var t=e.children,n=e.geometry,a=e.style;return Object(O.jsx)("div",{style:Object(d.a)(Object(d.a)({},a),{},{position:"absolute",left:"".concat(n.x,"%"),top:"".concat(n.y,"%"),height:"".concat(n.height,"%"),width:"".concat(n.width,"%")}),children:t})},x=function(e){var t=e.annotation,n=t.geometry;return Object(O.jsx)(f,{geometry:n,style:{border:"solid 3px white"},children:Object(O.jsx)("p",{className:"label-text-for-all",children:t.data&&t.data.text})},t.data.id)};var p=function(e){var t=e.labels,n=e.annotations,i=Object(a.useState)({}),s=Object(g.a)(i,2),o=s[0],c=s[1];return Object(a.useEffect)((function(){var e={};t.forEach((function(t){e[t]=0})),n.forEach((function(t){var n=t.data.text,a=e[n]?e[n]+1:1;e[n]=a})),c(e),console.log({tempData:e})}),[n]),Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("div",{className:"dataHolder",children:[Object(O.jsxs)("div",{className:"dataItem",children:[Object(O.jsx)("div",{className:"dataItemSno",children:"Sn."}),Object(O.jsx)("div",{className:"dataItemLabel",children:"Lables"}),Object(O.jsx)("div",{className:"dataItemValue",children:"Fq."})]}),Object.keys(o).map((function(e,t){return Object(O.jsxs)("div",{className:"dataItem",children:[Object(O.jsx)("div",{className:"dataItemSno",children:t+1}),Object(O.jsx)("div",{className:"dataItemLabel",children:e}),Object(O.jsx)("div",{className:"dataItemValue",children:o[e]})]},e)}))]})})},w=function(e){var t=e.increaseLabelFontSize,n=e.decreaseLabelFontSize,i=e.labelFontSize,s=e.renderImageToCanvas,o=e.togglePreview,c=e.canvasRef,d=(e.preview,e.labnelLineWidth),b=e.increaseLabelLineWidth,h=e.decreaseLabelLineWidth,u=Object(a.useState)(null),j=Object(g.a)(u,2),v=j[0],m=j[1],f=function(){var e=Object(r.a)(Object(l.a)().mark((function e(){var t,n;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(i,d);case 2:n=null===(t=c.current)||void 0===t?void 0:t.toDataURL(),m(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){f()}),[i,d]),Object(O.jsxs)("div",{className:"previewHolder",children:[Object(O.jsxs)("div",{className:"menu",children:[Object(O.jsx)("button",{className:"",onClick:o,children:"Close"}),Object(O.jsx)("button",{style:{backgroundColor:"grey"},children:"Font Size"}),Object(O.jsx)("button",{className:"",onClick:t,children:"+"}),Object(O.jsx)("button",{className:"",onClick:n,children:"-"}),Object(O.jsx)("button",{style:{backgroundColor:"grey"},children:"Line Width"}),Object(O.jsx)("button",{className:"",onClick:b,children:"+"}),Object(O.jsx)("button",{className:"",onClick:h,children:"-"})]}),!v&&Object(O.jsx)("p",{children:"Loading please wait ..."}),v&&Object(O.jsx)("img",{src:v,alt:"preview"})]})},L=n.p+"static/media/expand.9dd54df5.svg",S=n.p+"static/media/shrink.38fe5d9e.svg",y=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(e){var a,s;return Object(b.a)(this,n),(s=t.call(this,e)).canvasRef=i.a.createRef(),s.increaseLabelFontSize=function(){s.setState({labelFontSize:s.state.labelFontSize+5})},s.decreaseLabelFontSize=function(){s.setState({labelFontSize:s.state.labelFontSize-5})},s.increaseLabelLineWidth=function(){s.setState({labnelLineWidth:s.state.labnelLineWidth+4})},s.decreaseLabelLineWidth=function(){s.setState({labnelLineWidth:s.state.labnelLineWidth-4})},s.togglePreview=function(){s.setState({enablePreview:!s.state.enablePreview})},s.toggleLabels=function(){s.setState({showLabels:!s.state.showLabels})},s.enableEditing=function(){s.setState({isEditable:!s.state.isEditable})},s.toggleFullWidth=function(){s.setState({isFullWidth:!s.state.isFullWidth})},s.moveDiv=function(e){s.setState({coords:{x:e.clientX,y:e.clientY}})},s.onMouseMove=function(e){s.setState({showDiv:!0}),window.addEventListener("mousemove",s.moveDiv)},s.onMouseOut=function(e){s.setState({showDiv:!1}),window.removeEventListener("mousemove",s.moveDiv)},s.renderImageToCanvas=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.state.labelFontSize,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.state.labnelLineWidth;return new Promise((function(n){var a=s.canvasRef.current,i=a.getContext("2d"),o=new Image;o.onload=function(){a.width=o.width,a.height=o.height,i.drawImage(o,0,0,o.width,o.height),s.state.annotations.forEach((function(n){var a=n.geometry,s=n.data,c=a.x,l=a.y,r=a.width,d=a.height,b=s.text,h=c/100*o.width,u=l/100*o.height,j=r/100*o.width,v=d/100*o.height;i.beginPath(),i.rect(h,u,j,v),i.lineWidth=t,i.strokeStyle="red",i.stroke(),i.fillStyle="white",i.font="bold ".concat(e,"px Roboto"),i.fillText(b,h,u>e?u-t:u+e),i.fillStyle="black",i.fillRect(h,(u>e?u-t:u+e)-e-20,i.measureText(b).width+20,e+20),i.fillStyle="white",i.font="bold ".concat(e,"px Roboto"),i.fillText(b,h+10,u>e?u-t-10:u+e-10)})),n()},o.src="data:image/jpeg;base64,"+s.props.image}))},s.onChange=function(e){s.setState({annotation:e})},s.onSubmit=function(e){var t=e.geometry,n=e.data;s.setState({annotation:{},annotations:s.state.annotations.concat({geometry:t,data:Object(d.a)(Object(d.a)({},n),{},{id:Math.random()})})})},s.onChangeType=function(e){s.setState({annotation:{},type:e.currentTarget.innerHTML})},s.deleteAnnotation=function(e){s.setState({annotations:s.state.annotations.filter((function(t){return t.data.id!==e}))})},s.downloadImage=Object(r.a)(Object(l.a)().mark((function e(){var t,n,a;return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.renderImageToCanvas();case 2:n=null===(t=s.canvasRef.current)||void 0===t?void 0:t.toDataURL(),(a=document.createElement("a")).href=n,a.download="image.png",a.click();case 7:case"end":return e.stop()}}),e)}))),s.preview=Object(r.a)(Object(l.a)().mark((function e(){return Object(l.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.renderImageToCanvas();case 2:s.setState({enablePreview:!0});case 3:case"end":return e.stop()}}),e)}))),s.state={annotations:Object(c.a)(null===(a=s.props)||void 0===a?void 0:a.detectedAnotations),annotation:{},showDiv:!1,coords:{x:0,y:0},isEditable:!1,showLabels:!0,isFullWidth:!1,enablePreview:!1,labelFontSize:40,labnelLineWidth:5},s}return Object(h.a)(n,[{key:"componentWillUnmount",value:function(){window.removeEventListener("mousemove",this.moveDiv)}},{key:"render",value:function(){var e=this,t="data:image/jpeg;base64,"+this.props.image;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("div",{className:"menu",children:this.state.isEditable?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("button",{onClick:this.toggleLabels,children:[this.state.showLabels?"Hide":"Show"," Labels"]}),Object(O.jsx)("button",{onClick:this.downloadImage,children:"Download"}),Object(O.jsxs)("button",{onClick:this.togglePreview,children:[this.state.enablePreview?"Hide":"Show"," Preview"]}),Object(O.jsx)("button",{onClick:this.toggleFullWidth,children:this.state.isFullWidth?Object(O.jsx)("img",{src:L,alt:"expnad"}):Object(O.jsx)("img",{src:S,alt:"shink"})})]}):Object(O.jsx)(O.Fragment,{children:Object(O.jsx)("button",{onClick:this.enableEditing,children:"Edit labels"})})}),Object(O.jsxs)("div",{className:"parent",children:[Object(O.jsx)("div",{className:"hoverDiv image-editor",onMouseMove:this.onMouseMove,onMouseOut:this.onMouseOut,style:{maxWidth:this.state.isFullWidth?"unset":"900px"},children:Object(O.jsx)(m.a,{src:t,alt:"pcb",annotations:this.state.annotations,type:this.state.type,value:this.state.annotation,onChange:this.onChange,onSubmit:this.onSubmit,disableEditor:!this.state.isEditable,disableAnnotation:!this.state.isEditable,disableSelector:!this.state.isEditable,disableOverlay:!this.state.isEditable,renderEditor:function(t){return function(e,t){var n=e.annotation.geometry;return n?Object(O.jsxs)("div",{className:"holder",style:{background:"rgba(0, 0, 0, 0.15)",left:"".concat(n.x>80?75:n.x,"%"),top:"".concat(n.y>85?85:n.y,"%")},children:[Object(O.jsxs)("select",{className:"selectItem",onChange:function(t){e.onChange(Object(d.a)(Object(d.a)({},e.annotation),{},{data:Object(d.a)(Object(d.a)({},e.annotation.data),{},{text:t.target.value})}))},children:[Object(O.jsx)("option",{value:"",children:"Select..."}),t.map((function(e){return Object(O.jsx)("option",{value:e,children:e},e)}))]}),Object(O.jsx)("button",{className:"addLabelButton",onClick:e.onSubmit,children:"Add"})]}):null}(t,e.props.labels)},renderContent:x,renderHighlight:function(t){return function(e){var t=e.annotation,n=e.active,a=e.deleteAnnotation,i=e.showLabels,s=t.geometry,o=t.data;return s?Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)(f,{geometry:s,style:{border:"solid 3px ".concat(n?"#3e8e41":"red")},children:[n&&Object(O.jsx)("button",{className:"deleteAnnotationButton",onClick:function(){console.log("delete"),a(t.data.id)},children:"X"}),i&&Object(O.jsx)("p",{className:"label-text-for-all",children:o&&o.text})]},t.data.id)}):null}({annotation:t.annotation,active:t.active,showLabels:e.state.showLabels,deleteAnnotation:e.deleteAnnotation})}})}),Object(O.jsx)("div",{className:"dataViewer",children:Object(O.jsx)(p,{labels:this.props.labels,annotations:this.state.annotations})})]}),Object(O.jsx)("canvas",{ref:this.canvasRef,style:{display:"none"}}),this.state.enablePreview&&Object(O.jsx)(w,{increaseLabelFontSize:this.increaseLabelFontSize,decreaseLabelFontSize:this.decreaseLabelFontSize,labelFontSize:this.state.labelFontSize,renderImageToCanvas:this.renderImageToCanvas,togglePreview:this.togglePreview,canvasRef:this.canvasRef,labnelLineWidth:this.state.labnelLineWidth,increaseLabelLineWidth:this.increaseLabelLineWidth,decreaseLabelLineWidth:this.decreaseLabelLineWidth})]})}}]),n}(a.Component),F=function(e){Object(u.a)(n,e);var t=Object(j.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props.args,t=e.image,n=e.labels,a=e.detectedAnotations;return Object(O.jsx)(y,{image:t,labels:n,detectedAnotations:a})}}]),n}(v.a),k=Object(v.b)(F);o.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(k,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.c0d60b13.chunk.js.map