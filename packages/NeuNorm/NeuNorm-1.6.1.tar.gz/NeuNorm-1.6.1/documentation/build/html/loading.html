

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Loading &mdash; Normalization 0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Normalization 0 documentation" href="index.html"/>
        <link rel="next" title="Dark Field Correction" href="dark_field_correction.html"/>
        <link rel="prev" title="Installation" href="installation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Normalization
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Loading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#loading-via-folders">Loading via folders</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-via-individual-file-name">Loading via individual file name</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-via-list-file-names">Loading via list file names</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-via-arrays">Loading via arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-with-auto-gamma-filtering">Loading with Auto Gamma Filtering</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#how-does-the-auto-gamma-filter-works">How does the Auto Gamma filter works?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#loading-with-manual-gamma-filtering">Loading with Manual Gamma Filtering</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dark_field_correction.html">Dark Field Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="normalization.html">Normalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="cropping_data.html">Cropping Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="retrieve_normalized_data.html">Retrieve Normalized Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="export_data.html">Export Data</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Normalization</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Loading</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/loading.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="loading">
<h1>Loading<a class="headerlink" href="#loading" title="Permalink to this headline">¶</a></h1>
<p>You can load your data into the library using different methods:</p>
<ul class="simple">
<li>by defining the input folder</li>
<li>by defining the full file name, one at a time</li>
<li>by defining the the list of full file names</li>
<li>by giving directly the arrays of images</li>
</ul>
<div class="section" id="loading-via-folders">
<h2>Loading via folders<a class="headerlink" href="#loading-via-folders" title="Permalink to this headline">¶</a></h2>
<p>Let’s pretend that our images are in the folder <strong>/Users/me/sample/</strong> and named</p>
<ul class="simple">
<li>image001.fits</li>
<li>image002.fits</li>
<li>image003.fits</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sample_folder</span> <span class="o">=</span> <span class="s1">&#39;/Users/me/sample/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span> <span class="o">=</span> <span class="n">Normalization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">sample_folder</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point all the data have been loaded in memory and can be accessed as followed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image001</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image002</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>and the file names</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image003_file_name</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Let’s now load the rest of our data, the OB and the DF</p>
<p>Our OB are in the folder <strong>/Users/me/ob/</strong> and named</p>
<ul class="simple">
<li>ob001.fits</li>
<li>ob002.fits</li>
<li>ob003.fits</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="s1">&#39;/Users/me/ob&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>again, all the data can be retrieved as followed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ob1</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob2_file_name</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>For this library, DF are optional but for the sake of this exercise, let’s load them</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="s1">&#39;/Users/me/df&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, a gamma filtering will take place when you load your data. You can manually turn off
this filtering by adding the following False flag</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="s1">&#39;/Users/me/df&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">gamma_filter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The gamma filtering is an algorithm that replaces all the very bright pixel counts with the average value
of the 8 neighbors. What do we mean by very bright? The pixel counts that have 10% of their value above the average
counts of the entire image. The threshold value can be change by doing</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">gamma_filter_threshold</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>
</div>
<p><strong>WARNING:</strong>
#1 From this point, any operation on your data will overwrite the inital data loaded. Those
data can be retrieved at any point by doing
#2 The program won’t let you run the same algorithm twice (normalization, df_correction,
oscillation, rebin). But it’s possible to overwrite this option by making a flag <strong>force</strong>
equal to True. Use this feature at your own risk!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-via-individual-file-name">
<h2>Loading via individual file name<a class="headerlink" href="#loading-via-individual-file-name" title="Permalink to this headline">¶</a></h2>
<p>Let’s pretend that our images are in the folder <strong>/Users/me/sample/</strong> and named</p>
<ul class="simple">
<li>image001.fits</li>
<li>image002.fits</li>
<li>image003.fits</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span> <span class="o">=</span> <span class="n">Normalization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/sample/image001.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/sample/image002.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/sample/image003.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point all the data have been loaded in memory and can be accessed as followed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image001</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image002</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>and the file names</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image003_file_name</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Let’s now load the rest of our data, the OB and the DF</p>
<p>Our OB are in the folder <strong>/Users/me/ob/</strong> and named</p>
<ul class="simple">
<li>ob001.fits</li>
<li>ob002.fits</li>
<li>ob003.fits</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/ob/ob001.fits&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/ob/ob002.fits&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/ob/ob003.fits&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>again, all the data can be retrieved as followed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ob1</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob2_file_name</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>For this library, DF are optional but for the sake of this exercise, let’s load them</p>
<ul class="simple">
<li>df001.fits</li>
<li>df002.fits</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/df/df001.fits&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/df/df002.fits&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, a gamma filtering will take place when you load your data. You can manually turn off
this filtering by adding the following False flag</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/Users/me/df/df002.fits&#39;</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">gamma_filter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The gamma filtering is an algorithm that replaces all the very bright pixel counts with the average value
of the 8 neighbors. What do we mean by very bright? The pixel counts that have 10% of their value above the average
counts of the entire image. The threshold value can be change by doing</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">gamma_filter_threshold</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>
</div>
<p><strong>WARNING:</strong>
#1 From this point, any operation on your data will overwrite the inital data loaded. Those
data can be retrieved at any point by doing
#2 The program won’t let you run the same algorithm twice (normalization, df_correction,
oscillation, rebin). But it’s possible to overwrite this option by making a flag <strong>force</strong>
equal to True. Use this feature at your own risk!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-via-list-file-names">
<h2>Loading via list file names<a class="headerlink" href="#loading-via-list-file-names" title="Permalink to this headline">¶</a></h2>
<p>Let’s pretend that our images are in the folder <strong>/Users/me/sample/</strong> and named</p>
<ul class="simple">
<li>image001.fits</li>
<li>image002.fits</li>
<li>image003.fits</li>
</ul>
<p>But from this list, we only want to load image001 and image002. It is possible to specify a list of
file names to load</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span> <span class="o">=</span> <span class="n">Normalization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">list_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/Users/me/sample/image001.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;/Users/me/sample/image002.fits&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">list_files</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point all the data have been loaded in memory and can be accessed as followed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image001</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image002</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>and the file names</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image002_file_name</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Let’s now load the rest of our data, the OB and the DF</p>
<p>Our OB are in the folder <strong>/Users/me/ob/</strong> and named</p>
<ul class="simple">
<li>ob001.fits</li>
<li>ob002.fits</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">list_ob</span> <span class="o">=</span> <span class="p">[</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">me</span><span class="o">/</span><span class="n">ob</span><span class="o">/</span><span class="n">ob001</span><span class="o">.</span><span class="n">fits</span><span class="s1">&#39;, &#39;</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">me</span><span class="o">/</span><span class="n">ob</span><span class="o">/</span><span class="n">ob002</span><span class="o">.</span><span class="n">fits</span><span class="s1">&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">list_ob</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>again, all the data can be retrieved as followed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ob1</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob2_file_name</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>For this library, DF are optional but for the sake of this exercise, let’s load them</p>
<ul class="simple">
<li>df001.fits</li>
<li>df002.fits</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">list_df</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;/Users/me/df/df001.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;/Users/me/df/df002.fits&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">list_df</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, a gamma filtering will take place when you load your data. You can manually turn off
this filtering by adding the following False flag</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">list_df</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">gamma_filter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The gamma filtering is an algorithm that replaces all the very bright pixel counts with the average value
of the 8 neighbors. What do we mean by very bright? The pixel counts that have 10% of their value above the average
counts of the entire image. The threshold value can be change by doing</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">gamma_filter_threshold</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>
</div>
<p><strong>WARNING:</strong>
#1 From this point, any operation on your data will overwrite the inital data loaded. Those
data can be retrieved at any point by doing
#2 The program won’t let you run the same algorithm twice (normalization, df_correction,
oscillation, rebin). But it’s possible to overwrite this option by making a flag <strong>force</strong>
equal to True. Use this feature at your own risk!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-via-arrays">
<h2>Loading via arrays<a class="headerlink" href="#loading-via-arrays" title="Permalink to this headline">¶</a></h2>
<p>Let’s pretend that our images are in the folder <strong>/Users/me/sample/</strong> and named</p>
<ul class="simple">
<li>image001.tif</li>
<li>image002.tif</li>
<li>image003.tif</li>
</ul>
<p>In order to load the arrays, we first need to load ourselves the data</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_data1</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/me/sample/image001.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_data1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_data2</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/me/sample/image002.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_data2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_data3</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/me/sample/image003.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_data3</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we can load the data</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span> <span class="o">=</span> <span class="n">Normalization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point all the sample data have been loaded in memory and can be accessed as followed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image001</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image002</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>and the file names</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image003_file_name</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<p>Let’s now load the rest of our data, the OB and the DF</p>
<p>Our OB are in the folder <strong>/Users/me/ob/</strong> and named</p>
<ul class="simple">
<li>ob001.tif</li>
<li>ob002.tif</li>
<li>ob003.tif</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_ob1</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/me/sample/ob001.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">_ob1</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_ob2</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/me/sample/ob002.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">_ob2</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_ob3</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/me/sample/ob003.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">_ob3</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;ob&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>again, all the data can be retrieved as followed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ob1</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob2_file_name</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;file_name&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>For this library, DF are optional but for the sake of this exercise, let’s load them</p>
<ul class="simple">
<li>df001.tif</li>
<li>df002.tif</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">_df1</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/me/sample/df001.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">_df1</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_df2</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;/Users/me/sample/df002.tif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">_df2</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, a gamma filtering will take place when you load your data. You can manually turn off
this filtering by adding the following False flag</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">_df2</span><span class="p">,</span> <span class="n">data_type</span><span class="o">=</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="n">gamma_filter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The gamma filtering is an algorithm that replaces all the very bright pixel counts with the average value
of the 8 neighbors. What do we mean by very bright? The pixel counts that have 10% of their value above the average
counts of the entire image. The threshold value can be change by doing</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">gamma_filter_threshold</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>
</div>
<p><strong>WARNING:</strong>
#1 From this point, any operation on your data will overwrite the inital data loaded. Those
data can be retrieved at any point by doing
#2 The program won’t let you run the same algorithm twice (normalization, df_correction,
oscillation, rebin). But it’s possible to overwrite this option by making a flag <strong>force</strong>
equal to True. Use this feature at your own risk!</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sample&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ob</span> <span class="o">=</span> <span class="n">o_norm</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;ob&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="loading-with-auto-gamma-filtering">
<h2>Loading with Auto Gamma Filtering<a class="headerlink" href="#loading-with-auto-gamma-filtering" title="Permalink to this headline">¶</a></h2>
<p>By default the data are loaded with <strong>automatic gamma correction</strong> turned <strong>ON</strong>. You can easily turn off this
auto gamma correction this way</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sample_folder</span> <span class="o">=</span> <span class="s1">&#39;/Users/me/sample/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span> <span class="o">=</span> <span class="n">Normalization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">sample_folder</span><span class="p">,</span> <span class="n">auto_gamma_filter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="how-does-the-auto-gamma-filter-works">
<h3>How does the Auto Gamma filter works?<a class="headerlink" href="#how-does-the-auto-gamma-filter-works" title="Permalink to this headline">¶</a></h3>
<p>The program used the format of the input data files and will replace all the pixels for which their intensity is
equal or greater to the maximum value provided by this data file format - 5 (marging).</p>
<p>For example, if you are loading an image of type int16, the maximum value provided by this image is 32767. All pixels
with more counts than 32762 will be replaced by the average of the 8 surrounding pixels.</p>
</div>
</div>
<div class="section" id="loading-with-manual-gamma-filtering">
<h2>Loading with Manual Gamma Filtering<a class="headerlink" href="#loading-with-manual-gamma-filtering" title="Permalink to this headline">¶</a></h2>
<p>NeuNorm also allows you to define yourself your gama filtering threshold. To do so, load the data this way</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sample_folder</span> <span class="o">=</span> <span class="s1">&#39;/Users/me/sample/&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span> <span class="o">=</span> <span class="n">Normalization</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o_norm</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">folder</span><span class="o">=</span><span class="n">sample_folder</span><span class="p">,</span> <span class="n">auto_gamma_filter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">gamma_filter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>You must turn off the auto gamma filter otherwise the manual gamma filtering won’t be trigger.
In this case, the pixel will be considered as gamma pixels, and then be replaced the same way the auto gamma filter
does, this way</p>
<blockquote>
<div><ol class="arabic simple">
<li>The average value of the entire image is calculated</li>
<li>a copy of the raw image multiply by the threshold value is created</li>
<li>if there is any pixels in this image that is still above the raw image, it is a gamma pixel!</li>
</ol>
</div></blockquote>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dark_field_correction.html" class="btn btn-neutral float-right" title="Dark Field Correction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Jean Bilheux.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>